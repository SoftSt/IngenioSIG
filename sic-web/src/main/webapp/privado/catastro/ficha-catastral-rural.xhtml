<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                template="/WEB-INF/templates/default.xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:newvi="http://ec.com.newvi.faces/ui">
    <ui:define name="content">
        <h:panelGroup id="grupoFichaCatastralRural">

            <p:panel id="panelListaFichaCatastralRural" rendered="#{fichaCatastralRuralBB.esPantallaActual('PANTALLA_LISTADO')}">
                <h:form id="formularioListaFichaCatastralRural">  

                    <p:growl id="growl" showDetail="true" sticky="true" life="800"/>
                    <p:messages id="messages" showDetail="true" autoUpdate="true" closable="true" />
                    <p>
                        <h2>
                            <h:outputText styleClass="#{fichaCatastralRuralBB.iconoPantalla.textoEtiqueta}"/>
                            <h:outputText value=" #{fichaCatastralRuralBB.tituloPantalla.textoEtiqueta}"/>
                        </h2>
                    </p>
                    <p>#{fichaCatastralRuralBB.descripcionPantalla.textoEtiqueta}</p>
                    
                    
                    <p:dataTable id="listaFichaCatastralRural" var="fichaCatastral" widgetVar="listaFichaCatastralRuralTabla"
                                 value="#{fichaCatastralRuralBB.listaFichas}" rowKey="#{fichaCatastral.predio.codCatastral}" filteredValue="#{fichaCatastralRuralBB.listaFichasFiltradas}"
                                 paginator="true" rows="20" paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}" 
                                 rowsPerPageTemplate="10,15,20" 
                                 emptyMessage="No se han encontrado resultados" 
                                 paginatorPosition="bottom">
                        <p:column headerText="Codigo" sortBy="#{fichaCatastral.predio.nomCodigocatastral}" filterBy="#{fichaCatastral.predio.nomCodigocatastral}">
                            <h:outputText value="#{fichaCatastral.predio.nomCodigocatastral}" />
                        </p:column>

                        <p:column headerText="Propietario CI/RUC" sortBy="#{fichaCatastral.contribuyentePropiedad.codCedularuc}" filterBy="#{fichaCatastral.contribuyentePropiedad.codCedularuc}">
                            <h:outputText value="#{fichaCatastral.contribuyentePropiedad.codCedularuc}"/>
                        </p:column>

                        <p:column headerText="Nombre Propietario" sortBy="#{fichaCatastral.contribuyentePropiedad.nomApellidos} #{fichaCatastral.contribuyentePropiedad.nomNombres}" filterBy="#{fichaCatastral.contribuyentePropiedad.nomApellidos} #{fichaCatastral.contribuyentePropiedad.nomNombres}" >
                            <h:outputText value="#{fichaCatastral.contribuyentePropiedad.nomApellidos} #{fichaCatastral.contribuyentePropiedad.nomNombres}"/>
                        </p:column>

                        <p:column headerText="Eliminar" width="80" rendered="#{fichaCatastralRuralBB.esPantallaEliminacion}">
                            <p:commandButton actionListener="#{fichaCatastralRuralBB.eliminarPredio(fichaCatastral.predio.codCatastral)}" 
                                             icon="fa fa-trash"
                                             id="eliminarFichaCatastralRural"
                                             update="listaFichaCatastralRural :formularioListaFichaCatastralRural:growl :formularioListaFichaCatastralRural:messages" >
                                <p:confirm header="Eliminar Ficha Catastral" message="¿Está seguro?" icon="ui-icon-alert" />
                                <p:ajax update="toolTipDelete" process="@this" /> 
                            </p:commandButton>
                            <p:tooltip id="toolTipDelete" for="eliminarFichaCatastralRural" value="Eliminar Ficha Catastral" showEffect="fade" hideEffect="fade" position="bottom"/>
                        </p:column>
                        <p:column headerText="Editar" width="80" rendered="#{fichaCatastralRuralBB.esPantallaEdicion}">
                            <p:commandButton process="listaFichaCatastralRural" 
                                             actionListener="#{fichaCatastralRuralBB.seleccionarPredio(fichaCatastral.predio.codCatastral)}"
                                             icon="fa fa-edit"
                                             id="editarFichaCatastralRural"
                                             update="grupoFichaCatastralRural">
                                <p:ajax update="toolTipEdit" process="@this" /> 
                            </p:commandButton>
                            <p:tooltip id="toolTipEdit" for="editarFichaCatastralRural" value="Editar Ficha Catastral" showEffect="fade" hideEffect="fade" position="bottom"/>
                        </p:column>
                        <p:column headerText="Generar" width="80" rendered="#{fichaCatastralRuralBB.esPantallaFormularios}">
                            <p:remoteCommand name="rc" actionListener="#{fichaCatastralRuralBB.abrirDialogImpresionFormulario(fichaCatastral.predio.codCatastral)}"/>
                            <p:commandButton process="listaFichaCatastralRural" 
                                             icon="fa fa-angle-double-right"
                                             actionListener="#{fichaCatastralRuralBB.abrirDialogImpresionFormulario(fichaCatastral.predio.codCatastral)}"
                                             id="generarFormulario">

                            </p:commandButton>
                            <p:tooltip id="toolTipAdd" for="generarFormulario" value="Generar Reportes" showEffect="fade" hideEffect="fade" position="bottom"/>
                        </p:column>
                    </p:dataTable>

                    <p:dialog header="Seleccionar Formulario Económico" widgetVar="wgSeleccionFormulario"
                              modal="false" height="100">
                        <h:form id="formulacioDialog">
                            <p><h:outputText value="Seleccione el tipo de formulario económico que necesita" /></p>
                            <h:panelGrid columns="3">

                                <p:commandButton icon="fa fa-print" 
                                                 value="Notificación Avalúo" 
                                                 id="imprimirNotificacionAvaluo"
                                                 ajax="false"
                                                 update="grupoFichaCatastralRural"
                                                 onclick="PrimeFaces.monitorDownload(start, stop);">
                                    <p:fileDownload value="#{fichaCatastralRuralBB.imprimir('NOTIFICACION_AVALUO')}" />
                                </p:commandButton>

                                <p:commandButton icon="fa fa-print" 
                                                 value="Cerfiticación Avalúo" 
                                                 id="imprimirCerfiticacionAvaluo"
                                                 ajax="false"
                                                 update="grupoFichaCatastralRural"
                                                 onclick="PrimeFaces.monitorDownload(start, stop);">
                                    <p:fileDownload value="#{fichaCatastralRuralBB.imprimir('CERTIFICACION_AVALUO')}" />
                                </p:commandButton>
                                <p:commandButton icon="fa fa-print" 
                                                 value="Título Credito"
                                                 id="imprimirTituloCredito"
                                                 ajax="false"
                                                 update="grupoFichaCatastralRural"
                                                 onclick="PrimeFaces.monitorDownload(start, stop);">
                                    <p:fileDownload value="#{fichaCatastralRuralBB.imprimir('TITULO_CREDITO')}" />
                                </p:commandButton>
                            </h:panelGrid>
                        </h:form>
                    </p:dialog>
                    <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                        <p:commandButton value="Si" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                        <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                    </p:confirmDialog>
                </h:form>
            </p:panel>


            <p:panel id="panelFichaCatastralRural" rendered="#{fichaCatastralRuralBB.esPantallaActual('PANTALLA_EDICION')}">
                <h:form id="formularioFichaCatastralRural">
                    <p>
                        <h2>
                            <h:outputText styleClass="#{fichaCatastralRuralBB.iconoPantalla.textoEtiqueta}"/>
                            <h:outputText value=" #{fichaCatastralRuralBB.tituloPantalla.textoEtiqueta}"/>
                        </h2>
                    </p>
                    <p>#{fichaCatastralRuralBB.descripcionPantalla.textoEtiqueta}</p>

                    <p:messages id="mensajeFormulario" showDetail="true" autoUpdate="true" closable="true" />
                    <p:tooltip style="height:1px" />
                    <p:outputPanel id="opDetalleFichaCatastralRural">

                        <p:tabView dynamic="true" >
                            <p:tab title="Información del predio">
                                <h:panelGrid>
                                    <br/>
                                    <div style="font-size:1.2em;font-weight:bold;">Identificación Catastral del predio</div>
                                    <p:separator />
                                    <h:outputLabel for="codCatastral" value="Clave Catastral" style="font-weight: bold;"/>
                                    <h:outputLabel id="codCatastral" value="#{fichaCatastralRuralBB.predio.nomCodigocatastral}" />
                                    <p:message for="codCatastral" display="tooltip"/>

                                    <h:panelGrid columns="8">
                                        <p:inputMask id="codDPA" value="#{fichaCatastralRuralBB.predio.codDpa}" mask="999999" size="6"><p:ajax event="keyup" listener="#{fichaCatastralRuralBB.actualizarCodigoCatastral()}" update="codCatastral" /></p:inputMask>
                                        <p:inputMask id="codZona" value="#{fichaCatastralRuralBB.predio.codZona}" mask="99" size="2"><p:ajax event="keyup" listener="#{fichaCatastralRuralBB.actualizarCodigoCatastral()}" update="codCatastral" /></p:inputMask>
                                        <p:inputMask id="codSector" value="#{fichaCatastralRuralBB.predio.codSector}" mask="99" size="2"><p:ajax event="keyup" listener="#{fichaCatastralRuralBB.actualizarCodigoCatastral()}" update="codCatastral" /></p:inputMask>
                                        <p:inputMask id="codManzana" value="#{fichaCatastralRuralBB.predio.codManzana}" mask="99" size="2"><p:ajax event="keyup" listener="#{fichaCatastralRuralBB.actualizarCodigoCatastral()}" update="codCatastral" /></p:inputMask>
                                        <p:inputMask id="codPredio" value="#{fichaCatastralRuralBB.predio.codPredio}" mask="9999" size="4"><p:ajax event="keyup" listener="#{fichaCatastralRuralBB.actualizarCodigoCatastral()}" update="codCatastral" /></p:inputMask>
                                        <p:inputMask id="codRegTenencia" value="#{fichaCatastralRuralBB.predio.codRegimentenencia}" mask="99" size="2"><p:ajax event="keyup" listener="#{fichaCatastralRuralBB.actualizarCodigoCatastral()}" update="codCatastral" /></p:inputMask>
                                        <p:inputMask id="codHorizontal" value="#{fichaCatastralRuralBB.predio.codHorizontal}" mask="999" size="3"><p:ajax event="keyup" listener="#{fichaCatastralRuralBB.actualizarCodigoCatastral()}" update="codCatastral" /></p:inputMask>
                                        <p:selectOneMenu id="codZonaInfluencia" value="#{fichaCatastralRuralBB.predio.codZonaInfluencia}" style="width:30px" >
                                            <f:selectItems value="#{fichaCatastralRuralBB.listaZonaInfluencia}" var="zonaInfluencia" itemValue="#{zonaInfluencia}" itemLabel="#{zonaInfluencia.codZonaInfluencia}"/>
                                            <p:ajax event="change" update="@this" />
                                        </p:selectOneMenu>


                                        <h:outputLabel for="codDPA" value="Código nacional" style="font-size:0.7em;" />
                                        <h:outputLabel for="codZona" value="Zona" style="font-size:0.7em;" />
                                        <h:outputLabel for="codSector" value="Sector" style="font-size:0.7em;"/>
                                        <h:outputLabel for="codManzana" value="Manzana" style="font-size:0.7em;"/>
                                        <h:outputLabel for="codPredio" value="Predio" style="font-size:0.7em;"/>
                                        <h:outputLabel for="codRegTenencia" value="R. Tenencia" style="font-size:0.7em;"/>
                                        <h:outputLabel for="codHorizontal" value="P. Horizontal" style="font-size:0.7em;"/>
                                        <h:outputLabel for="codZonaInfluencia" value="Z. Influencia" style="font-size:0.7em;"/>

                                        <p:message for="codDPA" display="tooltip"/>
                                        <p:message for="codZona" display="tooltip"/>
                                        <p:message for="codSector" display="tooltip"/>
                                        <p:message for="codManzana" display="tooltip"/>
                                        <p:message for="codPredio" display="tooltip"/>
                                        <p:message for="codRegTenencia" display="tooltip"/>
                                        <p:message for="codHorizontal" display="tooltip"/>
                                        <p:message for="codZonaInfluencia" display="tooltip"/>
                                    </h:panelGrid>

                                    <h:outputLabel for="nomCodigocatastralanterior" value="Clave Catastral anterior" style="font-weight: bold;"/>
                                    <p:inputText id="nomCodigocatastralanterior" value="#{fichaCatastralRuralBB.predio.nomCodigocatastralanterior}" label="Codigo Catastral Anterior" size="50"/>
                                    <p:message for="nomCodigocatastralanterior" display="tooltip"/>

                                    <br/>
                                    <div style="font-size:1.2em;font-weight:bold;">Dirección del predio</div>
                                    <p:separator />

                                    <h:panelGrid columns="2">
                                        <h:outputLabel for="txtDireccion" value="Calle principal" style="font-weight: bold;" />
                                        <h:outputLabel for="nomNumero" value="Número" style="font-weight: bold;"/>

                                        <p:inputText id="txtDireccion" value="#{fichaCatastralRuralBB.predio.txtDireccion}" label="Calle" size="50" maxlength="100"/>
                                        <p:inputText id="nomNumero" value="#{fichaCatastralRuralBB.predio.nomNumero}" label="Número" size="10" maxlength="20"/>

                                        <p:message for="txtDireccion" display="tooltip"/>
                                        <p:message for="nomNumero" display="tooltip"/>
                                    </h:panelGrid>

                                    <h:outputLabel for="stsBarrio" value="Barrio/Sitio" style="font-weight: bold;"/>
                                    <p:inputText id="stsBarrio" value="#{fichaCatastralRuralBB.predio.stsBarrio}" label="Barrio/Sitio" size="50" maxlength="150"/>
                                    <p:message for="stsBarrio" display="tooltip"/>

                                    <p style="font-weight:bold;">Coordenadas planas de referencia</p>
                                    <h:panelGrid columns="2">
                                        <h:outputLabel for="valCoordenadaEste" value="Coordenada Este" style="font-weight: bold;"/>
                                        <h:outputLabel for="valCoordenadaNorte" value="Coordenada Norte" style="font-weight: bold;"/>

                                        <p:inputText id="valCoordenadaEste" value="#{fichaCatastralRuralBB.predio.valCoordenadaEste}" label="Coordenada Este"/>
                                        <p:inputText id="valCoordenadaNorte" value="#{fichaCatastralRuralBB.predio.valCoordenadaNorte}" label="Coordenada Norte"/>

                                        <p:message for="valCoordenadaEste" display="tooltip"/>
                                        <p:message for="valCoordenadaNorte" display="tooltip"/>
                                    </h:panelGrid>

                                    <br/>
                                    <div style="font-size:1.2em;font-weight:bold;">Superficies del predio</div>
                                    <p:separator />
                                    <h:outputLabel for="valAreaPredio" value="Área total del terreno" style="font-weight: bold;"/>
                                    <p:inputNumber id="valAreaPredio" value="#{fichaCatastralRuralBB.predio.valAreaPredio}" label="Area Total" size="50"/>
                                    <p:message for="valAreaPredio" display="tooltip"/>
                                    <h:outputLabel for="valAreaFrente" value="Frente principal" style="font-weight: bold;"/>
                                    <p:inputNumber id="valAreaFrente" value="#{fichaCatastralRuralBB.predio.valAreaFrente}" label="Frente principal" size="50"/>
                                    <p:message for="valAreaFrente" display="tooltip"/>
                                    <h:outputLabel for="valAreaFondo" value="Fondo relativo" style="font-weight: bold;"/>
                                    <p:inputNumber id="valAreaFondo" value="#{fichaCatastralRuralBB.predio.valAreaFondo}" label="Fondo relativo" size="50"/>
                                    <p:message for="valAreaFondo" display="tooltip"/>
                                    <h:outputLabel for="valAreaConstruccion" value="Área de construcción" style="font-weight: bold;"/>
                                    <p:inputNumber id="valAreaConstruccion" value="#{fichaCatastralRuralBB.predio.valAreaConstruccion}" label="Fondo Relativo" size="50"/>
                                    <p:message for="valAreaConstruccion" display="tooltip"/>

                                    <br/>
                                    <div style="font-size:1.2em;font-weight:bold;">Croquis del predio</div>
                                    <p:separator />
                                    <iframe id="iframeCenter" src="#{fichaCatastralRuralBB.direccionVisorPredios.concat(fichaCatastralRuralBB.obtenerCodigoLote())}" width="800px"  
                                            height="500px" frameborder="0">  
                                    </iframe> 

                                    <br/>
                                    <div style="font-size:1.2em;font-weight:bold;">Fotografías</div>
                                    <p:separator />

                                    <p:commandButton icon="fa fa-image"
                                                     value="Agregar imágenes"
                                                     id="btnImagenNueva"
                                                     actionListener="#{fichaCatastralRuralBB.abrirDialogCargaImagen()}"
                                                     update="galeriaImagenesPredio">
                                        <p:ajax update="toolTipImagenNueva" process="@this" />
                                    </p:commandButton>
                                    <p:tooltip id="toolTipImagenNueva" for="btnImagenNueva" value="Agregar Imagen" showEffect="fade" hideEffect="fade" position="bottom"/>

                                    <p:galleria value="#{fichaCatastralRuralBB.listaFotosJpg}" id="galeriaImagenesPredio" var="image" panelWidth="500" panelHeight="313" showCaption="false">
                                        <p:graphicImage value="#{sesionBean.obtenerImagen()}" width="500" height="313">
                                            <f:param name="imagen" value="#{image}"/>
                                        </p:graphicImage>
                                    </p:galleria>



                                    <br/>
                                    <div style="font-size:1.2em;font-weight:bold;">Colindantes</div>
                                    <p:separator />
                                    <h:outputLabel for="txtNorte" value="Norte" style="font-weight: bold;"/>
                                    <p:inputText id="txtNorte" value="#{fichaCatastralRuralBB.predio.txtNorte}" label="Norte" size="50" maxlength="150"/>
                                    <p:message for="txtNorte" display="tooltip"/>
                                    <h:outputLabel for="txtSur" value="Sur" style="font-weight: bold;"/>
                                    <p:inputText id="txtSur" value="#{fichaCatastralRuralBB.predio.txtSur}" label="Sur" size="50" maxlength="150"/>
                                    <p:message for="txtSur" display="tooltip"/>
                                    <h:outputLabel for="txtEste" value="Este" style="font-weight: bold;"/>
                                    <p:inputText id="txtEste" value="#{fichaCatastralRuralBB.predio.txtEste}" label="Este" size="50" maxlength="150"/>
                                    <p:message for="txtEste" display="tooltip"/>
                                    <h:outputLabel for="txtOeste" value="Oeste" style="font-weight: bold;"/>
                                    <p:inputText id="txtOeste" value="#{fichaCatastralRuralBB.predio.txtOeste}" label="Oeste" size="50" maxlength="150"/>
                                    <p:message for="txtOeste" display="tooltip"/>

                                </h:panelGrid>
                            </p:tab>
                            <p:tab title="Información del propietario y tenencia">
                                <h:panelGrid>
                                    <br/>
                                    <div style="font-size:1.2em;font-weight:bold;">Propietario</div>
                                    <p:separator />
                                    <h:outputLabel for="ci" value="CI/RUC" style="font-weight: bold;"/>
                                    <h:outputText id="ci" value="#{fichaCatastralRuralBB.propiedadActual.contribuyente.codCedularuc}"/>
                                    <p:message for="ci" display="tooltip"/>
                                    <h:outputLabel for="personeria" value="Apellidos y Nombres" style="font-weight: bold;"/>
                                    <h:outputText id="personeria" value="#{fichaCatastralRuralBB.propiedadActual.contribuyente.nomApellidos.trim()} #{fichaCatastralRuralBB.propiedadActual.contribuyente.nomNombres.trim()}"/>
                                    <p:message for="personeria" display="tooltip"/>
                                    <h:outputLabel for="razonSocial" value="Razón social" style="font-weight: bold;"/>
                                    <h:outputText id="razonSocial" value="#{fichaCatastralRuralBB.propiedadActual.contribuyente.nomRazonsocial.trim()}"/>
                                    <p:message for="razonSocial" display="tooltip"/>
                                    <h:panelGrid columns="2">
                                        <h:outputLabel for="direccion" value="Dirección" style="font-weight: bold;"/>
                                        <h:outputLabel for="ciudad" value="Ciudad" style="font-weight: bold;"/>
                                        <h:outputText id="direccion" value="#{fichaCatastralRuralBB.propiedadActual.contribuyente.txtDireccion.trim()}"/>
                                        <h:outputText id="ciudad" />
                                        <p:message for="direccion" display="tooltip"/>
                                        <p:message for="ciudad" display="tooltip"/>
                                    </h:panelGrid>
                                    <h:panelGrid columns="2">
                                        <h:outputLabel for="telefono" value="Teléfono" style="font-weight: bold;"/>
                                        <h:outputLabel for="correoElectronico" value="Correo electrónico" style="font-weight: bold;"/>
                                        <h:outputText id="telefono" value="#{fichaCatastralRuralBB.propiedadActual.contribuyente.txtTelefono.trim()}" />
                                        <h:outputText id="correoElectronico" value="#{fichaCatastralRuralBB.propiedadActual.contribuyente.txtEmail.trim()}"/>
                                        <p:message for="telefono" display="tooltip"/>
                                        <p:message for="correoElectronico" display="tooltip"/>
                                    </h:panelGrid>

                                    <br/>
                                    <div style="font-size:1.2em;font-weight:bold;">Representante legal</div>
                                    <p:separator />
                                    <h:outputLabel for="ciRepresentante" value="CI/RUC" style="font-weight: bold;"/>
                                    <h:outputText id="ciRepresentante" value="#{fichaCatastralRuralBB.propiedadActual.contribuyente.cedulaRepresentante.trim()}"/>
                                    <p:message for="ciRepresentante" display="tooltip"/>
                                    <h:outputLabel for="representante" value="Apellidos y Nombres" style="font-weight: bold;"/>
                                    <h:outputText id="representante" value="#{fichaCatastralRuralBB.propiedadActual.contribuyente.nombreRepresentante.trim()}"/>
                                    <p:message for="representante" display="tooltip"/>
                                    <h:outputLabel for="repDireccion" value="Dirección" style="font-weight: bold;"/>
                                    <h:outputText id="repDireccion" value="#{fichaCatastralRuralBB.propiedadActual.contribuyente.direccionRepresentante.trim()}"/>
                                    <p:message for="repDireccion" display="tooltip"/>

                                    <br/>
                                    <div style="font-size:1.2em;font-weight:bold;">Propietario anterior</div>
                                    <p:separator />
                                    <h:outputLabel for="propAnterior" value="Apellidos y Nombres" style="font-weight: bold;"/>
                                    <p:inputText id="propAnterior" label="Apellidos y Nombres" size="50"/>
                                    <p:message for="propAnterior" display="tooltip"/>

                                    <br/>
                                    <div style="font-size:1.2em;font-weight:bold;">Tenencia</div>                                    
                                    <p:separator />
                                    <p:commandButton value="Agregar información tenencia"
                                                     actionListener="#{fichaCatastralRuralBB.abrirDialogTenencia()}"
                                                     id="nuevaTenecia"
                                                     update="grupoFichaCatastralRural">
                                        <p:ajax update="toolTipInsertDescripcion" process="@this" />
                                    </p:commandButton>
                                    <p:tooltip id="toolTipInsertTenencia" for="nuevaTenecia" value="Agregar información tenencia" showEffect="fade" hideEffect="fade" position="bottom"/>

                                    <p:dataTable id="listaTenenciaPropietario" var="tenencia" widgetVar="listaTenenciaTabla"
                                                 value="#{fichaCatastralRuralBB.propiedadActual.tenenciasActivas}" rowKey="#{tenencia.codTenencia}" 
                                                 paginator="true" rows="10" paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}" 
                                                 rowsPerPageTemplate="10,15,20" 
                                                 emptyMessage="No se han encontrado resultados" 
                                                 paginatorPosition="bottom">

                                        <p:column headerText="Grupo" sortBy="#{tenencia.stsGrupo}">
                                            <h:outputText value="#{tenencia.stsGrupo}" />
                                        </p:column>

                                        <p:column headerText="SubGrupo" sortBy="#{tenencia.stsSubGrupo}">
                                            <h:outputText value="#{tenencia.stsSubgrupo}" />
                                        </p:column>

                                        <p:column headerText="Descripción" sortBy="#{tenencia.stsDescripcion}">
                                            <h:outputText value="#{tenencia.stsDescripcion}" />
                                        </p:column>

                                    </p:dataTable>

                                    <br/>
                                    <div style="font-size:1.2em;font-weight:bold;">Datos de la escritura</div>
                                    <p:separator />
                                    <h:panelGrid id="datosEscritura">
                                        <h:outputLabel for="lugarNotaria" value="Lugar" style="font-weight: bold;"/>
                                        <h:outputText id="lugarNotaria" value="#{fichaCatastralRuralBB.propiedadActual.txtCiudad}"/>
                                        <p:message for="lugarNotaria" display="tooltip"/>

                                        <h:outputLabel for="notaria" value="Notaria" style="font-weight: bold;"/>
                                        <h:outputText id="notaria" value="#{fichaCatastralRuralBB.propiedadActual.txtNotaria}"/>                                        
                                        <p:message for="notaria" display="tooltip"/>

                                        <h:outputLabel value="Fecha de inscripción" style="font-weight: bold;"/>
                                        <h:outputText id="fechaInscripcion" value="#{fichaCatastralRuralBB.propiedadActual.fecInscripcion}"/>
                                        <p:message for="fechaInscripcion" display="tooltip"/>

                                        <h:outputLabel value="Fecha escritura pública" style="font-weight: bold;"/>
                                        <h:outputText id="fechaEscritutaPublica" value="#{fichaCatastralRuralBB.propiedadActual.fecEscritura}"/>
                                        <p:message for="fechaEscritutaPublica" display="tooltip"/>
                                    </h:panelGrid>

                                    <br/>
                                    <div style="font-size:1.2em;font-weight:bold;">Informante</div>
                                    <p:separator />
                                    <h:outputLabel for="informante" value="Informante" style="font-weight: bold;"/>
                                    <h:outputText id="informante" value="#{fichaCatastralRuralBB.propiedadActual.txtInformante}"/>
                                    <p:message for="informante" display="tooltip"/>

                                    <h:outputLabel for="relacionInformante" value="Relación" style="font-weight: bold;"/>
                                    <h:outputText id="relacionInformante" value="#{fichaCatastralRuralBB.propiedadActual.txtInformanteRelacion}"/>
                                    <p:message for="relacionInformante" display="tooltip"/>

                                </h:panelGrid>
                            </p:tab>
                            <p:tab title="Terreno, Construcción y Servicios" id="tabTerrConstServ">
                                <p:growl id="growlTerrConstServ" showDetail="true" sticky="true" life="800"/>
                                <h:panelGrid >
                                    <br/>
                                    <div style="font-size:1.2em;font-weight:bold;">Descripción del terreno</div>
                                    <br/>

                                    <p:commandButton value="Agregar Descripcion del terreno"
                                                     actionListener="#{fichaCatastralRuralBB.abrirDialogDescripcionTerreno()}"
                                                     id="nuevaDescripcionTerreno"
                                                     update="listaDescripcionTerreno">
                                        <p:ajax update="toolTipInsertDescripcion" process="@this" />
                                    </p:commandButton>


                                    <p:tooltip id="toolTipInsertDescripcion" for="nuevaDescripcionTerreno" value="Agregar nuevo descripcion de terreno" showEffect="fade" hideEffect="fade" position="bottom"/>

                                    <p:dataTable id="listaDescripcionTerreno" var="descripcionTerreno" widgetVar="listaDescripcionTerrenoTabla"
                                                 value="#{fichaCatastralRuralBB.predio.caracteristicasTerrenoActivas}" rowKey="#{descripcionTerreno.codTerrenodetalle}" 
                                                 paginator="true" rows="10" paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}" 
                                                 rowsPerPageTemplate="10,15,20" 
                                                 emptyMessage="No se han encontrado resultados" 
                                                 paginatorPosition="bottom">

                                        <p:column headerText="Grupo" sortBy="#{descripcionTerreno.stsGrupo}">
                                            <h:outputText value="#{descripcionTerreno.stsGrupo}" />
                                        </p:column>

                                        <p:column headerText="Característica" sortBy="#{descripcionTerreno.stsSubGrupo}">
                                            <h:outputText value="#{descripcionTerreno.stsSubGrupo}" />
                                        </p:column>

                                        <p:column headerText="Detalle" sortBy="#{descripcionTerreno.stsDescripcion}">
                                            <h:outputText value="#{descripcionTerreno.stsDescripcion}" />
                                        </p:column>

                                        <p:column headerText="Eliminar" width="80">
                                            <p:commandButton actionListener="#{fichaCatastralRuralBB.eliminarTerreno(descripcionTerreno.codTerrenodetalle)}" 
                                                             icon="fa fa-trash"
                                                             id="eliminarTerreno"
                                                             update="grupoFichaCatastralRural">
                                                <p:confirm header="Eliminar Terreno" message="¿Está seguro?" icon="ui-icon-alert" />
                                                <p:ajax update="toolTipDeleteTerreno" process="@this" /> 
                                            </p:commandButton>
                                            <p:tooltip id="toolTipDeleteTerreno" for="eliminarTerreno" value="Eliminar Terreno" showEffect="fade" hideEffect="fade" position="bottom"/>
                                        </p:column>

                                    </p:dataTable>

                                    <br/>
                                    <div style="font-size:1.2em;font-weight:bold;">Infraestructura y Servicios</div>
                                    <br/>

                                    <p:commandButton value="Agregar Servicio"
                                                     actionListener="#{fichaCatastralRuralBB.abrirDialogServicios()}"
                                                     id="nuevoServicio"
                                                     update="listaServiciosBasicos">
                                        <p:ajax update="toolTipInsertServicio" process="@this" />
                                    </p:commandButton>

                                    <p:tooltip id="toolTipInsertServicio" for="nuevoServicio" value="Agregar nuevo servicio" showEffect="fade" hideEffect="fade" position="bottom"/>


                                    <p:dataTable id="listaServiciosBasicos" var="servicios" editable="true" widgetVar="listaSeviciosBasicosTabla"
                                                 value="#{fichaCatastralRuralBB.predio.servicosActivos}" rowKey="#{servicios.codServicios}" filteredValue=""
                                                 paginator="true" rows="10" paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}" 
                                                 rowsPerPageTemplate="10,15,20" 
                                                 emptyMessage="No se han encontrado resultados" 
                                                 paginatorPosition="bottom">

                                        <p:ajax event="rowEdit" listener="#{fichaCatastralRuralBB.actualizarServicioIngresado}" update="listaServiciosBasicos"/>

                                        <p:column headerText="Grupo" sortBy="#{servicios.stsGrupo}" width="40">
                                            <h:outputText value="#{servicios.stsGrupo}" />
                                        </p:column>

                                        <p:column headerText="Servicios" sortBy="#{servicios.stsSubGrupo}" width="40">
                                            <h:outputText value="#{servicios.stsSubGrupo}" />
                                        </p:column>

                                        <p:column headerText="Descripción" sortBy="#{servicios.stsDescripcion}" width="40">
                                            <h:outputText value="#{servicios.stsDescripcion}" />
                                        </p:column>

                                        <p:column headerText="Medidor" class="column-title-left" sortBy="#{servicios.nomMedidor}" width="35">
                                            <p:cellEditor>
                                                <f:facet name="output"><h:outputText value="#{servicios.nomMedidor}" /></f:facet>
                                                <f:facet name="input"><p:inputText value="#{servicios.nomMedidor}"/></f:facet>
                                            </p:cellEditor>
                                        </p:column>

                                        <p:column headerText="Estado" class="column-title-left" sortBy="#{servicios.stsEstado}" width="35">
                                            <p:cellEditor>
                                                <f:facet name="output"><h:outputText value="#{servicios.stsEstado}" /></f:facet>
                                                <f:facet name="input"><p:inputText value="#{servicios.stsEstado}"/></f:facet>
                                            </p:cellEditor>
                                        </p:column>

                                        <p:column headerText="# Medidores" class="column-title-left" sortBy="#{servicios.numMedidores}" width="35">
                                            <p:cellEditor>
                                                <f:facet name="output"><h:outputText value="#{servicios.numMedidores}" /></f:facet>
                                                <f:facet name="input"><p:inputText value="#{servicios.numMedidores}"/></f:facet>
                                            </p:cellEditor>
                                        </p:column>

                                        <p:column headerText="Opciones" width="18">
                                            <p:rowEditor/>
                                        </p:column>

                                        <p:column headerText="Eliminar" width="80">
                                            <p:commandButton actionListener="#{fichaCatastralRuralBB.eliminarServicio(servicios.codServicios)}" 
                                                             icon="fa fa-trash"
                                                             id="eliminarServicio"
                                                             update="grupoFichaCatastralRural">
                                                <p:confirm header="Eliminar Servicio" message="¿Está seguro?" icon="ui-icon-alert" />
                                                <p:ajax update="toolTipDeleteServicio" process="@this" /> 
                                            </p:commandButton>
                                            <p:tooltip id="toolTipDeleteServicio" for="eliminarServicio" value="Eliminar Servicio" showEffect="fade" hideEffect="fade" position="bottom"/>
                                        </p:column>
                                    </p:dataTable>

                                    <br/>
                                    <div style="font-size:1.2em;font-weight:bold;">Características de la edificación</div>

                                    <p style="font-weight:bold;">Información de Bloques</p>
                                    <br/>

                                    <p:commandButton value="Nuevo bloque"
                                                     actionListener="#{fichaCatastralRuralBB.agregarNuevoBloque()}"
                                                     id="nuevoBloque"
                                                     update="tabTerrConstServ growlTerrConstServ">
                                        <p:ajax update="toolTipInsert" process="@this" /> 
                                    </p:commandButton>
                                    <p:tooltip id="toolTipInsert" for="nuevoBloque" value="Agregar nuevo bloque" showEffect="fade" hideEffect="fade" position="bottom"/>


                                    <p:dataTable id="listaInformacionBloques" var="bloque" editable="true" widgetVar="listaInformacionBloquesTabla"
                                                 value="#{fichaCatastralRuralBB.predio.bloquesActivos}" rowKey="#{bloque.codBloques}"
                                                 emptyMessage="No se han encontrado resultados">
                                        <p:ajax event="rowEdit" listener="#{fichaCatastralRuralBB.actualizarBloqueIngresado}" update="listaInformacionBloques"/>

                                        <p:column style="width:16px">
                                            <p:rowToggler />
                                        </p:column>
                                        <p:column headerText="Bloque" class="column-title-left" width="60">
                                            <p:cellEditor>
                                                <f:facet name="output"><h:outputText value="#{bloque.nomBloque}" /></f:facet>
                                                <f:facet name="input"><p:inputText value="#{bloque.nomBloque}"/></f:facet>
                                            </p:cellEditor>
                                        </p:column>

                                        <p:column headerText="No. Pisos" class="column-title-left" width="220">
                                            <h:outputText value="#{bloque.valNropisos}" />
                                        </p:column>
                                        <p:column headerText="Opciones" width="60">
                                            <p:rowEditor/>
                                        </p:column>

                                        <p:column headerText="Eliminar" width="80">
                                            <p:commandButton actionListener="#{fichaCatastralRuralBB.eliminarBloque(bloque.codBloques)}" 
                                                             icon="fa fa-trash"
                                                             id="eliminarBloque"
                                                             update="grupoFichaCatastralRural">
                                                <p:confirm header="Eliminar Bloque" message="¿Está seguro?" icon="ui-icon-alert" />
                                                <p:ajax update="toolTipDeleteBloque" process="@this" /> 
                                            </p:commandButton>
                                            <p:tooltip id="toolTipDeleteBloque" for="eliminarBloque" value="Eliminar Bloque" showEffect="fade" hideEffect="fade" position="bottom"/>
                                        </p:column>

                                        <p:rowExpansion>
                                            <p style="font-weight:bold;">Información de Pisos</p>

                                            <p:commandButton value="Nuevo piso"
                                                             actionListener="#{fichaCatastralRuralBB.agregarNuevoPiso(bloque.codBloques)}"
                                                             id="nuevoPiso"
                                                             update="grupoFichaCatastralRural">
                                                <p:ajax update="toolTipInsertPiso" process="@this" />
                                            </p:commandButton>
                                            <p:tooltip id="toolTipInsertPiso" for="nuevoPiso" value="Agregar nuevo piso" showEffect="fade" hideEffect="fade" position="bottom"/>

                                            <p:dataTable id="listaInformacionPisos" var="piso" editable="true" widgetVar="listaInformacionPisosTabla"
                                                         value="#{bloque.pisosActivos}" rowKey="#{piso.codPisos}"
                                                         emptyMessage="No se han encontrado resultados">

                                                <p:ajax event="rowEdit" listener="#{fichaCatastralRuralBB.actualizarPisoIngresado(piso)}" update="listaInformacionPisos"/>

                                                <p:column style="width:16px">
                                                    <p:rowToggler />
                                                </p:column>
                                                <p:column headerText="Piso" class="column-title-left" sortBy="#{piso.nomPiso}" width="80">
                                                    <p:cellEditor>
                                                        <f:facet name="output"><h:outputText value="#{piso.nomPiso}" /></f:facet>
                                                        <f:facet name="input"><p:inputText value="#{piso.nomPiso}"/></f:facet>
                                                    </p:cellEditor>
                                                </p:column>

                                                <p:column headerText="Área (m2)" class="column-title-left" sortBy="#{piso.valAreapiso}" width="80">
                                                    <p:cellEditor>
                                                        <f:facet name="output"><h:outputText value="#{piso.valAreapiso}" /></f:facet>
                                                        <f:facet name="input"><p:inputText value="#{piso.valAreapiso}"/></f:facet>
                                                    </p:cellEditor>
                                                </p:column>

                                                <p:column headerText="Año construcción" class="column-title-left" sortBy="#{piso.valAnioconstruccion}" width="80">
                                                    <p:cellEditor>
                                                        <f:facet name="output"><h:outputText value="#{piso.valAnioconstruccion}" /></f:facet>
                                                        <f:facet name="input"><p:inputText value="#{piso.valAnioconstruccion}"/></f:facet>
                                                    </p:cellEditor>
                                                </p:column>

                                                <p:column headerText="Año reparación" class="column-title-left" sortBy="#{piso.valAnioreparacion}" width="80">
                                                    <p:cellEditor>
                                                        <f:facet name="output"><h:outputText value="#{piso.valAnioreparacion}" /></f:facet>
                                                        <f:facet name="input"><p:inputText value="#{piso.valAnioreparacion}"/></f:facet>
                                                    </p:cellEditor>
                                                </p:column>
                                                <p:column headerText="Estado" class="column-title-left" width="60">
                                                    <p:cellEditor>
                                                        <f:facet name="output"><h:outputText value="#{piso.stsEstado}" /></f:facet>
                                                        <f:facet name="input">
                                                            <h:selectOneMenu value="#{piso.stsEstado}" style="width:100%">
                                                                <f:selectItem itemLabel="Seleccione Uno"/>
                                                                <f:selectItems value="#{fichaCatastralRuralBB.listaEstadosPisos}" />
                                                            </h:selectOneMenu>
                                                        </f:facet>
                                                    </p:cellEditor>
                                                </p:column>

                                                <p:column headerText="Opciones" width="80">
                                                    <p:rowEditor/>
                                                </p:column>
                                                <p:column headerText="Eliminar" width="80">
                                                    <p:commandButton actionListener="#{fichaCatastralRuralBB.eliminarPiso(piso.codPisos)}" 
                                                                     icon="fa fa-trash"
                                                                     id="eliminarPiso"
                                                                     update="grupoFichaCatastralRural">
                                                        <p:confirm header="Eliminar Piso" message="¿Está seguro?" icon="ui-icon-alert" />
                                                        <p:ajax update="toolTipDeletePiso" process="@this" /> 
                                                    </p:commandButton>
                                                    <p:tooltip id="toolTipDeletePiso" for="eliminarPiso" value="Eliminar Piso" showEffect="fade" hideEffect="fade" position="bottom"/>
                                                </p:column>
                                                <p:rowExpansion>

                                                    <p style="font-weight:bold;">Detalle de construcción</p>
                                                    <br/>
                                                    <p:commandButton value="Agregar detalles"
                                                                     actionListener="#{fichaCatastralRuralBB.obtenerPisoSeleccionado(piso.codPisos)}"
                                                                     id="nuevoDetalle"
                                                                     update="listaElementosConstruccion">
                                                        <p:ajax update="toolTipInsertDetalle" process="@this" />
                                                    </p:commandButton>

                                                    <p:tooltip id="toolTipInsertDetalle" for="nuevoDetalle" value="Agregar nuevo detalle" showEffect="fade" hideEffect="fade" position="bottom"/>

                                                    <p:dataTable id="listaElementosConstruccion" editable="true" var="elementosConstruccion" scrollable="true" scrollHeight="250" widgetVar="listaElementosConstruccionTabla"
                                                                 value="#{piso.detallesPisosActivos}" rowKey="#{elementosConstruccion.codPisoDetalle}"
                                                                 emptyMessage="No se han encontrado resultados">

                                                        <p:ajax event="rowEdit" listener="#{fichaCatastralRuralBB.actualizarDetallePisoIngresado(elementosConstruccion)}" update="listaElementosConstruccion"/>

                                                        <p:column headerText="Código" class="column-title-left" sortBy="#{elementosConstruccion.codigo}" width="60">
                                                            <h:outputText value="#{elementosConstruccion.codigo}" />
                                                        </p:column>

                                                        <p:column headerText="Grupo" class="column-title-left" sortBy="#{elementosConstruccion.grupo}" width="60">
                                                            <h:outputText value="#{elementosConstruccion.grupo}" />
                                                        </p:column>

                                                        <p:column headerText="Subgrupo" class="column-title-left" sortBy="#{elementosConstruccion.subgrupo}" width="60" >
                                                            <h:outputText value="#{elementosConstruccion.subgrupo}" />
                                                        </p:column>

                                                        <p:column headerText="Material de construcción" class="column-title-left" sortBy="#{elementosConstruccion.descripcion}" width="60">
                                                            <h:outputText value="#{elementosConstruccion.descripcion}" />
                                                        </p:column>

                                                        <p:column headerText="Estado" class="column-title-left" width="60">
                                                            <p:cellEditor>
                                                                <f:facet name="output"><h:outputText value="#{elementosConstruccion.estadoDetalle}" /></f:facet>
                                                                <f:facet name="input">
                                                                    <h:selectOneMenu value="#{elementosConstruccion.estadoDetalle}" style="width:100%">
                                                                        <f:selectItem itemLabel="Seleccione Uno"/>
                                                                        <f:selectItems value="#{fichaCatastralRuralBB.listaEstadosDetallesPisos}" />
                                                                    </h:selectOneMenu>
                                                                </f:facet>
                                                            </p:cellEditor>
                                                        </p:column>
                                                        <p:column headerText="Opciones" width="60">
                                                            <p:rowEditor/>
                                                        </p:column>
                                                        <p:column headerText="Eliminar" width="80">
                                                            <p:commandButton actionListener="#{fichaCatastralRuralBB.eliminarDetallePiso(elementosConstruccion.codPisoDetalle)}" 
                                                                             icon="fa fa-trash"
                                                                             id="eliminarDetallePiso"
                                                                             update="grupoFichaCatastralRural">
                                                                <p:confirm header="Eliminar Detalle Piso" message="¿Está seguro?" icon="ui-icon-alert" />
                                                                <p:ajax update="toolTipDeleteDetallePiso" process="@this" /> 
                                                            </p:commandButton>
                                                            <p:tooltip id="toolTipDeleteDetallePiso" for="eliminarDetallePiso" value="Eliminar Detalle Piso" showEffect="fade" hideEffect="fade" position="bottom"/>
                                                        </p:column>
                                                    </p:dataTable>
                                                </p:rowExpansion>

                                            </p:dataTable>
                                        </p:rowExpansion>
                                    </p:dataTable>

                                </h:panelGrid>

                            </p:tab>
                            <p:tab title="Avalúo">

                                <h:panelGrid >
                                    <br/>
                                    <div style="font-size:1.2em;font-weight:bold;">Resumen Avalúo</div>
                                    <p:commandButton icon="fa fa-calculator" 
                                                     value="Calcular avalúo" 
                                                     id="calcularAvaluo"
                                                     ajax="false" actionListener="#{fichaCatastralRuralBB.calcularAvaluo()}"
                                                     update="grupoFichaCatastralRural">
                                    </p:commandButton>
                                    <p:separator />

                                    <p:treeTable value="#{fichaCatastralRuralBB.listaArbolAvaluo}"
                                                 id="listaArbolAvaluo" var="avaluo" resizableColumns="false"
                                                 emptyMessage="No se han encontrado resultados">

                                        <p:column headerText="Descripcion">
                                            <h:outputText value="#{avaluo.descripcion}"/>
                                        </p:column>

                                        <p:column headerText="Valor" style="text-align: right">
                                            <h:outputText value="#{avaluo.valor}"/>
                                        </p:column>

                                        <p:column headerText="Factor" style="text-align: right">
                                            <h:outputText value="#{avaluo.factor}"/>
                                        </p:column>

                                    </p:treeTable>
                                </h:panelGrid>
                            </p:tab>
                        </p:tabView>
                        <br/>
                        <h:panelGrid columns="6">

                            <p:commandButton actionListener="#{fichaCatastralRuralBB.actualizarPredio()}" 
                                             update="grupoFichaCatastralRural" 
                                             icon="fa fa-check"
                                             id="guardarFichaCatastralRural"
                                             value="Guardar">
                                <p:ajax update="toolTipSave" process="@this" /> 
                            </p:commandButton>
                            <p:tooltip id="toolTipSave" for="guardarFichaCatastralRural" value="Guardar cambios en ficha Catastral" showEffect="fade" hideEffect="fade" position="top"/>

                            <p:commandButton icon="fa fa-close" 
                                             value="Cerrar"
                                             id="cancelar"
                                             update="grupoFichaCatastralRural" 
                                             process="@this"
                                             actionListener="#{fichaCatastralRuralBB.cancelarEdicion()}">
                                <p:ajax update="toolTipCancel" process="@this" />
                                <p:resetInput target="panelFichaCatastralRural" />
                            </p:commandButton>
                            <p:tooltip id="toolTipCancel" for="cancelar" value="Regresar sin guardar cambios" showEffect="fade" hideEffect="fade" position="top"/>

                            <p:commandButton icon="fa fa-print" 
                                             value="Imprimir" 
                                             id="imprimir"
                                             ajax="false"
                                             update="grupoFichaCatastralRural"
                                             onclick="PrimeFaces.monitorDownload(start, stop);">
                                <p:fileDownload value="#{fichaCatastralRuralBB.imprimir('FICHA_RELEVAMIENTO_PREDIAL_URBANO')}" />
                            </p:commandButton>
                            <p:tooltip id="toolTipImprimir" for="imprimir" value="Imprimir" showEffect="fade" hideEffect="fade" position="top"/>

                        </h:panelGrid>
                        <br/>

                    </p:outputPanel>
                </h:form>

                <p:dialog header="Agregar detalles al piso" widgetVar="dlgDetallePiso" appendTo="@(body)" modal="true" showEffect="fade" hideEffect="fade" resizable="false" closable="true" width="550" height="400">
                    <p:growl id="messages2" showDetail="true" escape="false"/>
                    <p:treeTable value="#{fichaCatastralRuralBB.listaArbolPisosDetalle}"
                                 id="listaArbolPisosDetalle" var="dominio"
                                 selectionMode="single" selection="#{fichaCatastralRuralBB.pisosDetalleSeleccionado}"
                                 style="margin-top:0">
                        <p:ajax event="select" listener="#{fichaCatastralRuralBB.agregarDetallePiso}"/>

                        <p:column headerText="Descripcion" sortBy="#{dominio.descripcion}">
                            <h:outputText value="#{dominio.descripcion}"/>
                        </p:column>            
                    </p:treeTable>
                </p:dialog>

                <p:dialog header="Agregar nuevos servicios" widgetVar="dlgServicios" appendTo="@(body)" modal="true" showEffect="fade" hideEffect="fade" resizable="false" closable="true" width="550" height="400">
                    <p:growl id="messages3" showDetail="true" escape="false"/>
                    <p:treeTable value="#{fichaCatastralRuralBB.listaArbolServicios}"
                                 id="listaArbolServicios" var="servicio"
                                 selectionMode="single" selection="#{fichaCatastralRuralBB.servicioSeleccionado}" >

                        <p:ajax event="select" listener="#{fichaCatastralRuralBB.agregarServicio}" update="grupoFichaCatastralRural" />

                        <p:column headerText="Descripcion" sortBy="#{servicio.descripcion}">
                            <h:outputText value="#{servicio.descripcion}"/>
                        </p:column>            

                    </p:treeTable>
                </p:dialog>

                <p:dialog header="Edición de Propiedad" widgetVar="dlgPropiedad" appendTo="@(body)" modal="true" showEffect="fade" hideEffect="fade" resizable="false" closable="true" width="550" height="400">
                    <h:form id="dialogPropiedad">
                        <p:growl id="messagesw" showDetail="true" escape="false"/>
                        <div style="font-size:1.2em;font-weight:bold;">Tenencia</div>                                    
                        <p:separator />
                        <h:panelGrid>

                            <h:outputLabel for="tenenciaDominio" value="Dominio" style="font-weight: bold;"/>
                            <p:selectOneMenu id="tenenciaDominio" value="#{fichaCatastralRuralBB.propiedadActual.stsTenencia}" style="width:125px" >
                                <f:selectItem itemLabel="Seleccione tipo tenencia..." itemValue="null" />
                                <f:selectItems value="#{fichaCatastralRuralBB.listaTenenciaDominios}" var="tenenciaDominio" itemValue="#{tenenciaDominio}" itemLabel="#{tenenciaDominio.stsTenencia}"/>
                                <p:ajax event="change" update="@this" />
                            </p:selectOneMenu>
                            <p:message for="tenenciaDominio" display="tooltip"/>

                            <h:outputLabel for="transferenciaDominio" value="Dominio" style="font-weight: bold;"/>
                            <p:selectOneMenu id="transferenciaDominio" value="#{fichaCatastralRuralBB.propiedadActual.stsTransferenciadominio}" style="width:125px" >
                                <f:selectItem itemLabel="Seleccione tipo tenencia..." itemValue="null" />
                                <f:selectItems value="#{fichaCatastralRuralBB.listaTraslacion}" var="traslacionDominio" itemValue="#{traslacionDominio}" itemLabel="#{traslacionDominio.stsTransferenciadominio}"/>
                            </p:selectOneMenu>
                            <p:message for="transferenciaDominio" display="tooltip"/>

                            <h:outputLabel for="situacionActual" value="Situación" style="font-weight: bold;"/>
                            <p:selectOneMenu id="situacionActual" value="#{fichaCatastralRuralBB.propiedadActual.stsSituacion}" style="width:125px" >
                                <f:selectItem itemLabel="Seleccione tipo tenencia..." itemValue="null" />
                                <f:selectItems value="#{fichaCatastralRuralBB.listaSituacionActual}" var="situacionActual" itemValue="#{situacionActual}" itemLabel="#{situacionActual.stsSituacion}"/>
                            </p:selectOneMenu>
                            <p:message for="situacionActual" display="tooltip"/>


                            <div style="font-size:1.2em;font-weight:bold;">Datos de la escritura</div>
                            <p:separator />

                            <h:panelGrid>
                                <h:outputLabel for="estadoEscritura" value="Datos Tiene escritura" style="font-weight: bold;"/>
                                <p:selectOneMenu id="estadoEscritura" value="#{fichaCatastralRuralBB.propiedadActual.stsEscritura}" style="width:125px" >
                                    <f:selectItem itemLabel="Seleccione  un estado..." itemValue="null" />
                                    <f:selectItems value="#{fichaCatastralRuralBB.listaEstadoEscritura}" var="estadoEscritura" itemValue="#{estadoEscritura}" itemLabel="#{estadoEscritura.stsEscritura}"/>

                                </p:selectOneMenu>
                                <p:message for="estadoEscritura" display="tooltip"/>
                            </h:panelGrid>

                            <h:panelGrid id="datosEscritura">
                                <h:outputLabel for="lugarNotaria" value="Lugar" style="font-weight: bold;"/>
                                <p:inputText id="lugarNotaria" value="#{fichaCatastralRuralBB.propiedadActual.txtCiudad}" size="50"/>
                                <p:message for="lugarNotaria" display="tooltip"/>

                                <h:outputLabel for="notaria" value="Notaria" style="font-weight: bold;"/>
                                <p:inputText id="notaria" value="#{fichaCatastralRuralBB.propiedadActual.txtNotaria}" size="50"/>                                        
                                <p:message for="notaria" display="tooltip"/>


                                <p:outputLabel for="propFechaEscritura" value="Fecha escritura pública" style="font-weight: bold;" />
                                <p:inputMask id="propFechaEscritura" value="#{fichaCatastralRuralBB.propiedadActual.fecEscritura}" mask="99/99/9999"/>
                                <p:message for="propFechaEscritura" display="tooltip"/>

                                <p:outputLabel for="propFechaInscripcion" value="Fecha de inscripción " style="font-weight: bold;" />
                                <p:inputMask id="propFechaInscripcion" value="#{fichaCatastralRuralBB.propiedadActual.fecInscripcion}" mask="99/99/9999"/>
                                <p:message for="propFechaInscripcion" display="tooltip"/>

                                <!--<h:outputLabel value="Fecha de inscripción" style="font-weight: bold;"/>
                                <p:calendar id="propFechaInscripcion" navigator="true" value="#{fichaCatastralRuralBB.propiedadActual.fecInscripcion}" label="Fecha de inscripción" 
                                            showOn="button" size="10" pattern="dd/MM/yyyy" mask="true" >
                                    <p:watermark for="propFechaInscripcion" value="dd/mm/aaaa"/>
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </p:calendar>
                                <p:message for="propFechaInscripcion" display="tooltip"/>
                                
                                <h:outputLabel value="Fecha escritura pública" style="font-weight: bold;"/>
                                <p:calendar id="propFechaEscritura"  navigator="true" value="#{fichaCatastralRuralBB.propiedadActual.fecEscritura}" label="Fecha escritura pública" 
                                            showOn="button" size="10" pattern="dd/MM/yyyy" mask="true" >
                                    <p:watermark for="propFechaEscritura" value="dd/mm/aaaa"/>
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </p:calendar>
                                <p:message for="propFechaEscritura" display="tooltip"/>-->

                            </h:panelGrid>

                            <br/>
                            <div style="font-size:1.2em;font-weight:bold;">Informante</div>
                            <p:separator />
                            <h:outputLabel for="informante" value="Informante" style="font-weight: bold;"/>
                            <p:inputText id="informante" value="#{fichaCatastralRuralBB.propiedadActual.txtInformante}"/>
                            <p:message for="informante" display="tooltip"/>

                            <h:outputLabel for="relacionInformante" value="Relación" style="font-weight: bold;"/>
                            <p:inputText id="relacionInformante" value="#{fichaCatastralRuralBB.propiedadActual.txtInformanteRelacion}"/>
                            <p:message for="relacionInformante" display="tooltip"/>

                            <h:panelGrid columns="4">

                                <p:commandButton actionListener="#{fichaCatastralRuralBB.actualizarPropiedad(fichaCatastralRuralBB.propiedadActual.codPropiedad)}" 
                                                 update="grupoFichaCatastralRural" 
                                                 icon="fa fa-check"
                                                 id="guardarFichaCatastralRural"
                                                 value="Guardar">
                                    <p:ajax update="toolTipSave" process="@this" /> 
                                </p:commandButton>
                                <p:tooltip id="toolTipSave" for="guardarFichaCatastralRural" value="Guardar cambios en ficha Catastral" showEffect="fade" hideEffect="fade" position="top"/>
                            </h:panelGrid>
                            <br/>
                        </h:panelGrid>
                    </h:form>
                </p:dialog>

                <p:dialog header="Agregar nuevos descripcion al terreno" widgetVar="dlgDescripcionTerreno" appendTo="@(body)" modal="true" showEffect="fade" hideEffect="fade" resizable="false" closable="true" width="550" height="400">
                    <p:treeTable value="#{fichaCatastralRuralBB.listaArbolDescripcionTerreno}"
                                 id="listaArbolDescripcionTerreno" var="descripcionTerreno"
                                 selectionMode="single" selection="#{fichaCatastralRuralBB.descripcionTerrenoSeleccionado}" >

                        <p:ajax event="select" listener="#{fichaCatastralRuralBB.agregarDescripcionTerreno}" update="grupoFichaCatastralRural" />

                        <p:column headerText="Descripcion" sortBy="#{descripcionTerreno.descripcion}">
                            <h:outputText value="#{descripcionTerreno.descripcion}"/>
                        </p:column>            

                    </p:treeTable>
                </p:dialog>
                <p:dialog header="Agregar elementos de tenencia" widgetVar="dlgTenencia" appendTo="@(body)" modal="true" showEffect="fade" hideEffect="fade" resizable="false" closable="true" width="550" height="400">
                    <p:treeTable value="#{fichaCatastralRuralBB.listaArbolTenencia}"
                                 id="listaArbolTenencia" var="tenencia"
                                 selectionMode="single" selection="#{fichaCatastralRuralBB.tenenciaSeleccionada}" >

                        <p:ajax event="select" listener="#{fichaCatastralRuralBB.agregarTenenciaSeleccionada}" update="grupoFichaCatastralRural" />

                        <p:column headerText="Descripcion" sortBy="#{tenencia.descripcion}">
                            <h:outputText value="#{tenencia.descripcion}"/>
                        </p:column>            

                    </p:treeTable>
                </p:dialog>

                <p:dialog widgetVar="dlgCargaImagen" modal="true" appendTo="@(body)" 
                          showEffect="fade" hideEffect="fade" resizable="false" closeOnEscape="true" width="600">
                    <h:form id="formCargaImagen">
                        <p:outputPanel id="oppCargaImagen" style="text-align:left;">
                            <h:panelGrid id="pgCargaImagen" >
                                <br/>
                                <div style="font-size:1.2em;font-weight:bold;">Seleccione las imágenes del predio a cargar:</div>
                                <p:fileUpload fileUploadListener="#{fichaCatastralRuralBB.cargarImagen}" mode="advanced" dragDropSupport="false"
                                              update="grupoFichaCatastralRural" multiple="true" fileLimit="1"
                                              allowTypes="/(\.|\/)(jpe?g)$/" 
                                              label="Seleccionar" uploadLabel="Cargar" cancelLabel="Cancelar"
                                              invalidFileMessage="Archivo inválido, solo se permite extensiones: jpg, JPG"
                                              invalidSizeMessage="Archivo demasiado extenso"
                                              fileLimitMessage="Solo se puede cargar una imagen a la vez"/>
                            </h:panelGrid>
                        </p:outputPanel>
                    </h:form>
                </p:dialog>

            </p:panel>

        </h:panelGroup>


    </ui:define>
</ui:composition>
